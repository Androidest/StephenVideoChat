{"version":3,"sources":["../node_modules/peerjs/dist sync","commons/SharedStyle.js","commons/FBase.js","commons/constants.js","providers/AuthProvider.js","providers/PeerClient_MeProvider.js","commons/LocalStorage.js","providers/PeerClient_UsersProvider.js","providers/PeerClientProvider.js","providers/PeerServerProvider.js","views_router/GroupChat.js","views_router/Home.js","assets/blue_planet.svg","assets/cyan_planet.svg","assets/earth.svg","assets/jupiter.svg","assets/moon.svg","assets/orange_planet.svg","assets/red_planet.svg","assets/ring_planet.svg","assets/star.svg","views/LoginSpace.js","commons/SharedAnim.js","views/BounceButton.js","assets/loading.svg","views/LoadingAnim.js","views/LoginPanel1.js","views/LoginPanel2.js","views/PopupContainer.js","views_router/Login.js","views_router/Profile.js","views_router/AppRouter.js","App.js","_init_/reportWebVitals.js","index.js"],"names":["webpackEmptyContext","req","e","Error","code","keys","resolve","module","exports","id","flex_row","css","flex_col","Css","horz","left","center","right","in_space","in_out_space","vert","top","bottom","stretch","hover_blink","forward","backward","img_protection","GlobalStyle","createGlobalStyle","dbAuth","this","localDataKey","user","onAuthStateChangeCallback","expireTime","date","Date","time","getTime","window","localStorage","setItem","JSON","stringify","removeItem","callback","item","getItem","parse","setUser","email","password","a","Promise","reject","setTimeout","SERVER_DATA_TYPE","peerClientID","v4","replaceAll","peerServerID","peerConfig","iceServers","url","sdpSemantics","authContext","AES","encrypt","decrypt","createContext","reCreateUser","AuthProvider","children","useState","isInit","setInit","signInWithEmailAndPassword","error","console","warn","stack","signOut","useEffect","onAuthStateChanged","newUser","contextValue","login","logout","Provider","value","useAuth","useContext","defaultInfo","name","slice","photoURL","imageValidationRegex","nameValidationRegex","meContext","PeerClient_MeProvider","key","initialValue","isClearHistory","data","setData","Function","useLocalStorage","info","setInfo","meValue","setPhoto","fileBlob","test","reader","FileReader","onloadend","currentTarget","result","readAsDataURL","setName","newName","isConfirm","length","useMe","usersContext","PeerClient_UsersProvider","peerClient","usePeerClient","list","setList","setOnUsersSnapshot","setupList","users","userList","push","initContext","InitProvider","auth","me","isConnectedToServer","setConnectedToServer","clientRef","useRef","peer","serverConnection","onUsersSnapshot","createClientPeer","current","Peer","on","err","log","chatUserValue","connectToServer","connect","send","type","PeerClientProvider","serverContext","PeerServerProvider","serverRef","connections","createServerPeer","connection","setupConnection","curConnection","curId","GroupChat","Div","styled","div","UserSlot","SlotContainer","UserPhoto","src","SlotInnerContainer","Home","UserList","map","index","img","Panel","x","y","slowDown","springProps","style","transform","xy","interpolate","tx","ty","PanelDiv","Planet","svg","w","width","Img","LoginSpace","useSpring","config","mass","tension","friction","props","set","calc","innerWidth","innerHeight","Container","onMouseMove","clientX","clientY","StarImg","Star","Orange","Jupiter","Ring","Blue","Red","Cyan","Earth","Moon","animated","useScaleAnim","initScale","scale","v","newScale","onRest","useShakeAnim","transformFunc","state","percentage","range","output","memo","className","onMouseDown","onMouseUp","onMouseLeave","rest","setScale","Button","button","i","tensor","velocity","LoadingImg","LoadingSVG","InvitationCode","reference","animStyle","triggerShaking","Input","placeholder","LoginPanel1","inputRef","setPassword","setError","isLoading","setLoading","onClick","isSuccess","onChange","target","ErrorMsg","p","input","BounceButton","shakeStyle","scaleStyle","setStyle","Label","htmlFor","FileInput","accept","UserName","LoginPanel2","nameRef","photoRef","location","useLocation","history","useHistory","replace","from","HOME","event","files","label","isPopup","isShownAtStart","handler","popup","delay","hide","PopupDiv","PanelSwitcher","popupRef","panelID","setPanelID","Popup","Login","PopupContainer","Profile","LOGIN","GROUPCHAT","PROFILE","DefaultRoute","redirectPath","path","to","pathname","LoginRouter","exact","MainRouter","Navigation","NavButton","AppRouter","server","client","BigLodingAnim","Version","LoadingAnim","Link","AppContainer","App","reportWebVitals","onPerfEntry","then","getCLS","getFID","getFCP","getLCP","getTTFB","ReactDOM","render","StrictMode","document","getElementById"],"mappings":"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","file":"static/js/main.758db313.chunk.js","sourcesContent":["function webpackEmptyContext(req) {\n\tvar e = new Error(\"Cannot find module '\" + req + \"'\");\n\te.code = 'MODULE_NOT_FOUND';\n\tthrow e;\n}\nwebpackEmptyContext.keys = function() { return []; };\nwebpackEmptyContext.resolve = webpackEmptyContext;\nmodule.exports = webpackEmptyContext;\nwebpackEmptyContext.id = 267;","//通用Style\r\nimport styled, { createGlobalStyle, css } from \"styled-components\"\r\n\r\n//############### Styled #############################################################################\r\nexport const Styled = {\r\n    \r\n}\r\n\r\n\r\n\r\n//############### CSS #############################################################################\r\nconst flex_row = css `\r\n    display: flex;\r\n    flex-direction: row;\r\n`;\r\n\r\nconst flex_col = css `\r\n    display: flex;\r\n    flex-direction: column;\r\n`;\r\n\r\nexport const Css = {\r\n    //简化 flex的使用\r\n    //==================== flex row =====================\r\n    flex_row: {\r\n        horz: {\r\n            left : css ` ${flex_row} justify-content: flex-start;`,\r\n            center : css ` ${flex_row} justify-content: center;`,\r\n            right : css ` ${flex_row} justify-content: flex-end;`,\r\n            in_space : css ` ${flex_row} justify-content: space-between;`,\r\n            in_out_space : css ` ${flex_row} justify-content: space-evenly;`\r\n        },\r\n        \r\n        vert: {\r\n            top : css `align-items:flex-start;`,\r\n            center : css `align-items:center;`,\r\n            bottom : css `align-items:flex-end;`,\r\n            stretch : css `align-items:stretch;`\r\n        }\r\n    },\r\n    //简化 flex的使用\r\n    //==================== flex col =====================\r\n    flex_col: {\r\n        vert: {\r\n            top : css ` ${flex_col} justify-content: flex-start;`,\r\n            center : css ` ${flex_col} justify-content: center;`,\r\n            bottom : css ` ${flex_col} justify-content: flex-end;`,\r\n            in_space : css ` ${flex_col} justify-content: space-between;`,\r\n            in_out_space : css ` ${flex_col} justify-content: space-evenly;`\r\n        },\r\n        \r\n        horz: {\r\n            left : css `align-items:flex-start;`,\r\n            center : css `align-items:center;`,\r\n            right : css `align-items:flex-end;`,\r\n            stretch : css `align-items:stretch;`\r\n        }\r\n    },\r\n\r\n    //========== css transition 闪光动画 =============\r\n    hover_blink: {\r\n        //从往右的闪光效果\r\n        forward: css `\r\n            :after {\r\n                content: '';\r\n                position: absolute;\r\n                top: 0;\r\n                left: 0;\r\n                width: 0;\r\n                height: 100%;\r\n                background-color: rgba(255,255,255,0.4);\r\n                -webkit-transition: none;\r\n                -moz-transition: none;\r\n                transition: none;\r\n                border-radius: 6ch;\r\n            }\r\n            \r\n            :hover:after {\r\n                width: 120%;\r\n                background-color: rgba(255,255,255,0);\r\n                -webkit-transition: all 1s ease-in-out;\r\n                -moz-transition: all 1s ease-in-out;\r\n                transition: all 1s ease-in-out;\r\n            }\r\n        `,\r\n        //效果往回缩\r\n        backward: css `\r\n            :not(:hover):after {\r\n            width: 0;\r\n            background-color: rgba(255,255,255,0.4);\r\n            -webkit-transition: all 0.5s ease-out;\r\n            -moz-transition: all 0.5s ease-out;\r\n            transition: all 0.5s ease-out;\r\n        }`\r\n    },\r\n\r\n    img_protection: css `\r\n        ${'' /* 防止用户鼠标拖动选择出现蓝筐 */}\r\n        user-select: none;\r\n        ${'' /* 防止拖动图片 */}\r\n        user-drag: none;\r\n        ${'' /* 防止下载图片 */}\r\n        pointer-events: none;\r\n    `\r\n}\r\n\r\n\r\n\r\n//############### Global Style #####################################################################\r\nexport const GlobalStyle = createGlobalStyle `\r\n    html, body, #root {\r\n        height: 100%;\r\n        width: 100%;\r\n\t    overflow: hidden;\r\n    }\r\n\r\n    body {\r\n        margin: 0;\r\n        background-color: rgb(255, 255, 255);\r\n        font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Roboto', 'Oxygen',\r\n            'Ubuntu', 'Cantarell', 'Fira Sans', 'Droid Sans', 'Helvetica Neue',\r\n            sans-serif;\r\n        -webkit-font-smoothing: antialiased;\r\n        -moz-osx-font-smoothing: grayscale;\r\n        user-select: none; \r\n        user-drag: none;\r\n    }\r\n\r\n    .img {\r\n        ${Css.img_protection}\r\n    }\r\n\r\n    code {\r\n        font-family: source-code-pro, Menlo, Monaco, Consolas, 'Courier New', monospace;\r\n    }\r\n`; ","// Google Firebase 初始化和模块导出\r\n// import firebase from \"firebase/app\";\r\n// import \"firebase/auth\";\r\n// import \"firebase/firestore\";\r\n// import \"firebase/analytics\";\r\n\r\n// {\r\n//     const firebaseConfig = {\r\n//         apiKey: \"AIzaSyByUAid1ySJpc7RGmLGdtsuceuFLJcr32A\",\r\n//         authDomain: \"react-tensor-app.firebaseapp.com\",\r\n//         projectId: \"react-tensor-app\",\r\n//         storageBucket: \"react-tensor-app.appspot.com\",\r\n//         messagingSenderId: \"710084648290\",\r\n//         appId: \"1:710084648290:web:f9b770ead99b5f0c8aa03b\",\r\n//         measurementId: \"G-L446FGJC6L\"\r\n//     };\r\n    \r\n//     // Initialize Firebase\r\n//     firebase.initializeApp(firebaseConfig);\r\n//     firebase.analytics();\r\n// }\r\n\r\n// export const db = firebase;\r\n// export const dbAuth = Firenfirebase.auth();\r\n// export const dbStore = firebase.firestore();\r\n\r\n\r\n//========= 模拟的离线 Firebase （用于Demo，在国内无梯子的情况下，无法使用Firebase）=================\r\nclass FakeFireBase {\r\n    constructor() {\r\n        this.localDataKey = 'LastLoginState';\r\n        this.user = null;\r\n        this.onAuthStateChangeCallback = null;\r\n        this.expireTime = 30*60*1000; //从最近一次登录开始，30分钟内保持自动登录状态，登出后清除状态\r\n    }\r\n\r\n    //================== 用localStorage 记录最近一次登录状态，用于模拟自动登录 ==================\r\n    setUser(user) {\r\n        this.user = user;\r\n        if(user) {\r\n            const date = new Date();\r\n            user.time = date.getTime();\r\n            window.localStorage.setItem(this.localDataKey, JSON.stringify(user));\r\n        }\r\n        else {\r\n            window.localStorage.removeItem(this.localDataKey);\r\n        }\r\n        this.onAuthStateChangeCallback && this.onAuthStateChangeCallback(user);\r\n    }\r\n\r\n    //================== 模拟 firebase.auth().onAuthStateChanged() ，监听登录状态 ==================\r\n    onAuthStateChanged(callback) {\r\n        this.onAuthStateChangeCallback = callback;\r\n        const item = window.localStorage.getItem(this.localDataKey);  //local storage 存储序列化形式的对象 (json string)\r\n        if(item) {\r\n            const user = JSON.parse(item);\r\n            const date = new Date();\r\n            if(date.getTime() - user.time < this.expireTime) {\r\n                this.setUser(user);\r\n                return;\r\n            }\r\n        }\r\n        this.setUser(null);\r\n    }\r\n\r\n    //================= 模拟 firebase.auth().signInWithEmailAndPassword() 的手动登录 ================\r\n    async signInWithEmailAndPassword(email, password) {\r\n        return new Promise((resolve, reject)=>{\r\n            setTimeout(()=>{\r\n                if(email === 'stephen@invited.com' && password === 'niubideren666' ) {  \r\n                    this.setUser({ id: 'Stephen-FakeServer-user-id' });\r\n                    resolve(this.user);\r\n                }\r\n                else {\r\n                    reject(null);\r\n                }\r\n            }, 3000); //模拟验证时间\r\n        });\r\n    }\r\n    \r\n    //================= 模拟 firebase.auth().signOut() 的手动登出 ================\r\n    async signOut() {\r\n        return new Promise((resolve, reject)=>{\r\n            setTimeout(()=>{\r\n                this.setUser(null);\r\n                resolve(true);\r\n            }, 500); //模拟登出时间\r\n        });\r\n    }\r\n}\r\n\r\nexport const dbAuth = new FakeFireBase();\r\n","//==== 常量 =====\r\nimport { v4 } from 'uuid';\r\n\r\nexport const version = '1.0.0';\r\nexport const isTesting = false;\r\nexport const SERVER_DATA_TYPE = {\r\n    NEW_USER: 1,\r\n    USERS_SNAPSHOT: 2,\r\n}\r\nexport const peerClientID = 'StphClientID_'+v4().replaceAll('-','_'); //将减号代替成下划线，字母开头\r\nexport const peerServerID = 'Alan-Stephen-Leong-Song_ServerID_mJygpKissLS4vM';\r\nexport const peerConfig = { \r\n    iceServers: [\r\n        {url:'stun:stun.fwdnet.net'},\r\n        {url:'stun:stun.ideasip.com'},\r\n        {url:'stun:stun.iptel.org'},\r\n        {url:'stun:stun.rixtelecom.se'},\r\n        {url:'stun:stun.schlund.de'},\r\n        {url:'stun:stunserver.org'},\r\n        {url:'stun:stun.voiparound.com'},\r\n        {url:'stun:stun.voipbuster.com'},\r\n        {url:'stun:stun.voipstunt.com'},\r\n        {url:'stun:stun.voxgratia.org'},\r\n        {url:'stun:stun.xten.com'},\r\n        {url:'stun:stun01.sipphone.com'},\r\n        {url:'stun:stun.l.google.com:19302'},\r\n        {url:'stun:stun1.l.google.com:19302'},\r\n        {url:'stun:stun2.l.google.com:19302'},\r\n        {url:'stun:stun3.l.google.com:19302'},\r\n        {url:'stun:stun4.l.google.com:19302'},\r\n        // { \r\n        //     url: 'turn:homeo@turn.bistri.com:80', \r\n        //     credential: 'homeo' \r\n        // },\r\n        // {\r\n        //     urls: [\"turn:13.250.13.83:3478?transport=udp\"],\r\n        //     username: \"YzYNCouZM1mhqhmseWk6\",\r\n        //     credential: \"YzYNCouZM1mhqhmseWk6\"\r\n        // },\r\n        // {\r\n        //     url: 'turn:numb.viagenie.ca',\r\n        //     credential: 'muazkh',\r\n        //     username: 'webrtc@live.com'\r\n        // },\r\n        // {\r\n        //     url: 'turn:192.158.29.39:3478?transport=udp',\r\n        //     credential: 'JZEOEt2V3Qb0y27GRntt2u2PAYA=',\r\n        //     username: '28224511:1379330808'\r\n        // },\r\n        // {\r\n        //     url: 'turn:192.158.29.39:3478?transport=tcp',\r\n        //     credential: 'JZEOEt2V3Qb0y27GRntt2u2PAYA=',\r\n        //     username: '28224511:1379330808'\r\n        // },\r\n        // {\r\n        //     url: 'turn:turn.anyfirewall.com:443?transport=tcp',\r\n        //     credential: 'webrtc',\r\n        //     username: 'webrtc'\r\n        // }\r\n    ], \r\n    sdpSemantics: 'unified-plan' \r\n};\r\n\r\n\r\n\r\nexport const DEFAULT_PHOTO = 'data:image/png;base64,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';","//AuthProvider 用于允许登入者拥有访问服务器的权限，使用一个特定账号登录，并非社交用户。\r\n//社交用户请看PeerClientProvider\r\nimport { createContext, useContext, useEffect, useState } from \"react\";\r\nimport { AES } from \"crypto-js\";\r\nimport { dbAuth } from \"../commons/FBase\";\r\nimport { isTesting } from \"commons/constants\";\r\nconst { encrypt:ec, decrypt:dc} = AES;\r\n\r\n\r\n// ====== 自定义用户验证 context 对象 =============\r\nconst authContext = createContext(null);\r\n\r\n//========= functions ================\r\nfunction reCreateUser(user) {\r\n    const { id } = user;\r\n    return { id }; //immutable\r\n}\r\n\r\n// ====== 自定义context container =============\r\nexport default function AuthProvider({ children }) {\r\n    const [user, setUser] = useState();\r\n    const [isInit, setInit] = useState(false); //可以知道是否正在自动登录\r\n\r\n    //============== 初始化 =========================\r\n    useEffect(async ()=>{\r\n        //测试时跳过登录界面\r\n        if(isTesting){\r\n            setUser({});\r\n            setInit(true);\r\n            return;\r\n        }\r\n        // 手动登入登出成功后，或启动时自动登录成功后，都会进来一次\r\n        dbAuth.onAuthStateChanged((newUser)=>{\r\n            newUser = newUser? reCreateUser(newUser):null ;\r\n            setUser(newUser); // newUser\r\n            setInit(true); //若上次登出了，下次启动时onAuthStateChanged立刻触发，并且user为null\r\n        });\r\n\r\n    },[])\r\n\r\n\r\n    //=============== 手动登录 ======================\r\n    async function login(email, password) {\r\n        try{\r\n            // 由于使用 dbAuth.onAuthStateChanged 统一手动登录和自动登录，在此不需要获得user\r\n            // const {user} = await dbAuth.signInWithEmailAndPassword(email, password);\r\n            await dbAuth.signInWithEmailAndPassword(email, password);\r\n            return Promise.resolve(true);  //提示登入成功，登录界面可以知道什么时候redirect\r\n        }\r\n        catch(e){\r\n            const error = new Error();\r\n            console.warn(error.stack);\r\n        }\r\n        return Promise.resolve(false); //提示登入失败，登录界面可以知道密码对不对\r\n    }\r\n    \r\n\r\n    //=============== 手动登出 ===================\r\n    async function logout() {\r\n        try{\r\n            await dbAuth.signOut();\r\n            return Promise.resolve(true);\r\n        }\r\n        catch(e){\r\n            return Promise.resolve(false);\r\n        }\r\n    }\r\n\r\n\r\n    const contextValue = {isInit, user, login, logout};\r\n    return (\r\n        <authContext.Provider value={contextValue}> \r\n            {children}\r\n        </authContext.Provider>\r\n    )\r\n} \r\n\r\n// ====== 自定义context hook =============\r\n/**\r\n * @description AuthProvider 的子组件可以使用 useAuth() 获得用户验证相关hook\r\n * @return {{isInit:boolean, user:object, login:Function, logout:Function}}\r\n */\r\nexport function useAuth() {\r\n    return useContext(authContext);\r\n}","// PeerClientProvider 为社交用户，本app使用者，一个浏览器一个。\r\nimport { useLocalStorage } from \"commons/LocalStorage\";\r\nimport { createContext, useContext, useEffect, useState } from \"react\";\r\nimport { DEFAULT_PHOTO, peerClientID } from 'commons/constants';\r\n\r\n// ================== constant ===================\r\nconst isClearHistory = true;  //测试是可以使 isClearHistory=true 重置浏览器上的记录\r\nconst defaultInfo = {\r\n    name: \"YourName-\" + peerClientID.slice(-6,-1),\r\n    photoURL: DEFAULT_PHOTO \r\n};\r\n// 开头接受任何字符：^[^]+ \r\n// 一个'.'后接其中一种并以此结尾： [.]{1}(jpeg|jpg|png|gif)$\r\nconst imageValidationRegex = /^[^]+[.]{1}(jpeg|jpg|png|gif)$/;  //imageValidationRegex.test(path) 全match才真\r\nconst nameValidationRegex = /^([A-Z]|[a-z]|[0-9]|-){0,15}$/; //只接受字母、数字和减号并且字符串长度在15以内\r\n\r\n\r\n// ====== 自定义社交用户的 context 对象 =============\r\nconst meContext = createContext(null);\r\n\r\n\r\n// ====== 自定义context container =============\r\n//当前用户的数据\r\nexport default function PeerClient_MeProvider({ children }) {\r\n    const [info, setInfo] = useLocalStorage('info', defaultInfo, isClearHistory); \r\n\r\n    //fileBlob 是从 input 组件的 onChange 输入参数 event.target.files[0] 得到\r\n    const setPhoto = (fileBlob)=>{\r\n        //TODO add promise\r\n        if(imageValidationRegex.test(fileBlob.name)) {\r\n            //验证文件为有效图片后开始读取文件\r\n            const reader = new FileReader();\r\n            reader.onloadend = (e) => {\r\n                setInfo({ ...info, photoURL: e.currentTarget.result });  //合并 me，覆盖 photoURL\r\n            };\r\n            reader.readAsDataURL(fileBlob);\r\n        }\r\n        else {\r\n            throw 'Invalid image file!';\r\n        }\r\n    }\r\n\r\n    //设置名称时，在输入框 onChange 里使 isConfirm=false 可以边输入边防止非法输入，同时允许名称长度小于6,\r\n    //用在最终名称确认时，使 isConfirm=true 以防止名称长度小于6，同时保证正确的输入格式\r\n    const setName = (newName, isConfirm)=> {\r\n        if(nameValidationRegex.test(newName)) {\r\n            if(isConfirm && newName.length < 6) //最终确定名字时确认是否大于等于6个字符\r\n                throw 'User name must be 6-15 characters!';\r\n            setInfo({ ...info, name: newName });  //合并 me，覆盖 name\r\n        }\r\n        else if(15 <= newName.length) { //名字太长\r\n            throw 'User name must be 6-15 characters!';\r\n        }\r\n        else {\r\n            throw 'Invalid character!';\r\n        }\r\n    }\r\n\r\n    const meValue = { info, setPhoto, setName };\r\n\r\n    return (\r\n        <meContext.Provider value={meValue}> \r\n            {children}\r\n        </meContext.Provider>\r\n    )\r\n}\r\n\r\n\r\n// ====== 自定义context hook =============\r\n/**\r\n * @description PeerClientProvider 的子组件可以使用 useMe() 获得当前社交用户的hook\r\n * @return {{ info:object, setPhoto:Function, setName:Function }}\r\n */\r\nexport function useMe() {\r\n    return useContext(meContext);\r\n}\r\n","//使用 localStorage 的便捷hook\r\nimport { useState } from \"react\";\r\n\r\n/**\r\n * @description useLocalStorage 将数据存于浏览器内，不受页面刷新影响\r\n * @param {string} key - 数据键值\r\n * @param {object} initialValue - 数据初始值\r\n * @param {boolean} isClearHistory - 是否清除旧数据\r\n * @return {[data:object, storeData:Function]}\r\n */\r\nexport function useLocalStorage(key, initialValue, isClearHistory) {\r\n\r\n    //若isClear为真清除旧数据，完全删除键值\r\n    const [data, setData] = useState(() => {\r\n        isClearHistory && window.localStorage.removeItem(key);\r\n\r\n        try {\r\n            const item = window.localStorage.getItem(key);  //local storage 存储序列化形式的对象 (json string)\r\n            if(item) {\r\n                //localStorage 有数据的时候\r\n                return JSON.parse(item);\r\n            }\r\n            else {\r\n                //localStorage 上没有数据的时候，创建新的记录，使用初始默认数据\r\n                window.localStorage.setItem(key, JSON.stringify(initialValue));\r\n                return initialValue;\r\n            }\r\n        } \r\n        catch (error) {\r\n            console.error(error);\r\n            return initialValue;\r\n        }\r\n    });\r\n  \r\n    \r\n    const storeData = (value) => {\r\n        try {\r\n            value = (value instanceof Function) ? value(data) : value; //value 也可以是函数与setState用法一样\r\n            window.localStorage.setItem(key, JSON.stringify(value)); //先将对象序列化再存储\r\n            setData(value); //程序内更新值\r\n        } \r\n        catch (error) {\r\n            console.error(error);\r\n        }\r\n    };\r\n  \r\n    return [data, storeData];\r\n}","// PeerClientProvider 为社交用户，本app使用者，一个浏览器一个。\r\nimport { peerClientID } from \"commons/constants\";\r\nimport { createContext, useContext, useEffect, useState } from \"react\";\r\nimport { usePeerClient } from \"./PeerClientProvider\";\r\n\r\n// ====== 自定义社交用户的 context 对象 =============\r\nconst usersContext = createContext(null);\r\n\r\n\r\n//存储其他已连接的用户的相关数据\r\nexport default function PeerClient_UsersProvider({ children }) {\r\n    const peerClient = usePeerClient();\r\n    const [list, setList] = useState([]);\r\n\r\n    useEffect(()=>{\r\n        peerClient.setOnUsersSnapshot(setupList);\r\n    },[]);\r\n    \r\n    const setupList = (users)=> {\r\n        delete users[peerClientID];\r\n\r\n        const userList = [];\r\n        for(const id in users) {\r\n            const user = users[id];\r\n            user.id = id;\r\n            userList.push(user);\r\n        }\r\n        setList(userList);\r\n    }\r\n\r\n    const contextValue = { list };\r\n    return (\r\n        <usersContext.Provider value={contextValue}> \r\n            {children}\r\n        </usersContext.Provider>\r\n    )\r\n} \r\n\r\n/**\r\n * @description PeerClientProvider 的子组件可以使用 useClientUsers() 获得其他社交用户的hook\r\n * @return {{ list:object }}\r\n */\r\nexport function useClientUsers() {\r\n    return useContext(usersContext);\r\n}","// PeerClientProvider 为社交用户，本app使用者，一个浏览器一个。\r\nimport { createContext, useContext, useEffect, useRef, useState } from \"react\";\r\nimport { useAuth } from \"providers/AuthProvider\";\r\nimport PeerClient_MeProvider, { useMe } from \"providers/PeerClient_MeProvider\";\r\nimport PeerClient_UsersProvider from \"providers/PeerClient_UsersProvider\";\r\nimport Peer from \"peerjs\";\r\nimport { peerClientID, peerConfig, peerServerID, SERVER_DATA_TYPE } from \"commons/constants\";\r\n\r\n\r\nconst initContext = createContext(null);\r\n\r\n\r\n//=============== Peer Client 初始化 ======================\r\nfunction InitProvider({ children }) {\r\n    const auth = useAuth();\r\n    const me = useMe();\r\n    const [isInit, setInit] = useState(false);\r\n    const [isConnectedToServer, setConnectedToServer] = useState(false);\r\n    const clientRef = useRef({ peer:null, serverConnection:null, onUsersSnapshot:()=>{} });\r\n\r\n    //================= 初始化 ===========================\r\n    useEffect(()=> {\r\n        if(auth.user == null) {\r\n            setConnectedToServer(false); //使登出后重新登录时，可以进入设置角色的开始界面（LoginPanel2）\r\n        }\r\n        createClientPeer();\r\n        \r\n    }, [auth.user]); //登出时会触发\r\n\r\n\r\n    ///============== 创建 peer client =======================\r\n    const createClientPeer = ()=> {\r\n        if(clientRef.current.peer) return; //防止因auth的更新而被多次初始化，不能用isInit判断\r\n\r\n        const peer = new Peer(peerClientID, peerConfig);\r\n        clientRef.current.peer = peer;\r\n\r\n        peer.on('open', (id)=> {\r\n            if (peer.id === null) {\r\n                peer.id = peerClientID;\r\n            }\r\n            setInit(true);\r\n        });\r\n\r\n        peer.on('error', (err)=> {\r\n            console.log(err);\r\n        });\r\n\r\n        // window.addEventListener(\"beforeunload\", (ev) => {  \r\n        //     ev.returnValue = 'Are you sure you want to close?';\r\n        //     return;\r\n        // });\r\n    }\r\n\r\n    //============== 连接服务器 =======================\r\n    const connectToServer = ()=> {\r\n        if(clientRef.current.serverConnection) {\r\n            setConnectedToServer(true);\r\n            return;\r\n        }\r\n\r\n        const serverConnection = clientRef.current.peer.connect(peerServerID);\r\n\r\n        serverConnection.on('open', ()=> {\r\n            console.log(\"Connected to peer server\");\r\n            clientRef.current.serverConnection = serverConnection;\r\n            setConnectedToServer(true);\r\n\r\n            serverConnection.send({ \r\n                type: SERVER_DATA_TYPE.NEW_USER, \r\n                user: me.info \r\n            });\r\n        });\r\n        \r\n        serverConnection.on('data', (data)=> {\r\n            if(data.type === SERVER_DATA_TYPE.USERS_SNAPSHOT && data.users) {\r\n                clientRef.current.onUsersSnapshot(data.users);\r\n            }\r\n        });\r\n    };\r\n\r\n    const setOnUsersSnapshot = (callback)=> {\r\n        clientRef.current.onUsersSnapshot = callback;\r\n    }\r\n    \r\n    //============== Provider ===================\r\n    const chatUserValue = { isInit, isConnectedToServer, connectToServer, setOnUsersSnapshot };\r\n    return (\r\n        <initContext.Provider value={chatUserValue}>\r\n            {children}\r\n        </initContext.Provider>\r\n    )\r\n} \r\n\r\n\r\n\r\n//主provider逻辑模块， 在此将PeerClientProvider分割成三个小模块\r\n//是为了防止在一个 state 更新时，即使组件没有使用这个state \r\n//而使用其他同 Provider 的 state 也会被连带重渲染\r\nexport default function PeerClientProvider({ children }) {\r\n    return (\r\n        <PeerClient_MeProvider>  \r\n            <InitProvider> \r\n                <PeerClient_UsersProvider>\r\n                    {children}\r\n                </PeerClient_UsersProvider>\r\n            </InitProvider>\r\n        </PeerClient_MeProvider>\r\n    )\r\n} \r\n\r\n\r\n// ====== 自定义context hook =============\r\n/**\r\n * @description PeerClientProvider 的子组件可以使用 usePeerClient() 获得PeerClientProvider的状态\r\n * @return {{ isInit:boolean, isConnectedToServer:boolean, connectToServer:Function, setOnUsersSnapshot:Function }}\r\n */\r\nexport function usePeerClient() {\r\n    return useContext(initContext);\r\n}","// PeerClientProvider 为社交用户，本app使用者，一个浏览器一个。\r\nimport Peer from \"peerjs\";\r\nimport { peerConfig, peerServerID, SERVER_DATA_TYPE } from 'commons/constants';\r\nimport { createContext, useContext, useEffect, useState, useRef } from \"react\";\r\n\r\n\r\nconst serverContext = createContext(null);\r\n\r\n\r\nexport default function PeerServerProvider({ children }) {\r\n    const [isInit, setInit] = useState(false);\r\n\tconst serverRef = useRef({ peer:null, connections: {}, users:{} });\r\n\r\n    //=============== 初始化节点服务器 =========================\r\n    useEffect(() => {\r\n        createServerPeer(serverRef);\r\n    }, []);\r\n\t \r\n\r\n    //============== 创建 peer server =======================\r\n    const createServerPeer = (serverRef)=> {\r\n        if(serverRef.current.peer) return;\r\n\r\n        console.log('Trying to create a peer server ...');\r\n\r\n        const peer = new Peer(peerServerID, peerConfig);\r\n        serverRef.current.peer = peer;\r\n\r\n        peer.on(\"open\", (id) => {\r\n            console.log('A Peer Server is created on this instance!');\r\n            setInit(true);\r\n        });\r\n        \r\n        peer.on(\"connection\", (connection) => {\r\n            console.log(\"Incoming connection id: \", connection.peer);\r\n            setupConnection(connection);\r\n        });\r\n    \r\n        peer.on('error', (error)=> {\r\n            if(error.type === \"unavailable-id\") {\r\n                serverRef.current.peer = null;\r\n                setInit(true);\r\n            }\r\n        });\r\n    }\r\n\r\n    //============== 建立新的连接 =======================\r\n    const setupConnection = (curConnection)=> {\r\n        const connections = serverRef.current.connections;\r\n        const users = serverRef.current.users;\r\n        const curId = curConnection.peer;\r\n        \r\n        curConnection.on(\"data\", (data) => {\r\n            if(data.type === SERVER_DATA_TYPE.NEW_USER && data.user) {\r\n                connections[curId] = curConnection;\r\n                users[curId] = data.user;\r\n                for(const id in connections) {\r\n                    connections[id].send({ \r\n                        type: SERVER_DATA_TYPE.USERS_SNAPSHOT,\r\n                        users\r\n                    });\r\n                }\r\n            }\r\n        });\r\n    }\r\n\r\n    //============== Provider ===================\r\n    const contextValue = { isInit };\r\n    return (\r\n        <serverContext.Provider value={contextValue}>\r\n            {children}\r\n        </serverContext.Provider>\r\n    )\r\n} \r\n\r\n\r\n// ====== 自定义context hook =============\r\n/**\r\n * @description PeerServerProvider 的子组件可以使用 usePeerServer() 获得PeerServer的创建状态\r\n * @return {{ isInit:boolean }}\r\n */\r\nexport function usePeerServer() {\r\n    return useContext(serverContext);\r\n}","import { Css } from \"commons/SharedStyle\";\r\nimport { useEffect, useRef, useState } from \"react\";\r\nimport styled from \"styled-components\";\r\n\r\nexport default function GroupChat() {\r\n\t\r\n\r\n\treturn (\r\n\t\t<Div>\r\n\t\t\t\r\n\t\t</Div>\r\n\t)\r\n}\r\n\r\nconst Div = styled.div `\r\n\theight: 400px;\r\n\twidth: 100%;\r\n\tbackground-color: lightcyan;\r\n\t${Css.flex_col.vert.center}\r\n\t${Css.flex_col.horz.center}\r\n\tuser-select: text;\r\n`","import { Css } from \"commons/SharedStyle\";\r\nimport { usePeerClient } from \"providers/PeerClientProvider\";\r\nimport { useClientUsers } from \"providers/PeerClient_UsersProvider\";\r\nimport { useEffect,useState } from \"react\";\r\nimport styled from \"styled-components\";\r\n\r\nfunction UserSlot({user}) {\r\n\r\n\treturn (\r\n\t\t<SlotContainer>\r\n\t\t\t<UserPhoto src={user.photoURL}/>\r\n\t\t\t<SlotInnerContainer>{user.name}</SlotInnerContainer> \r\n\t\t</SlotContainer>\r\n\t);\r\n}\r\n\r\nexport default function Home() {\r\n\tconst {list} = useClientUsers();\r\n\t\r\n\treturn (\r\n\t\t<UserList>\r\n\t\t\t{list.map((user, index)=>(\r\n\t\t\t\t<UserSlot user={user} />\r\n\t\t\t))}\r\n\t\t</UserList>\r\n\t)\r\n}\r\n\r\nconst UserPhoto = styled.img `\r\n\theight: 6ch;\r\n\twidth: 6ch;\r\n\tborder-radius: 3ch;\r\n\tmargin: 3ch;\r\n`;\r\n\r\nconst SlotContainer = styled.div `\r\n\theight: 10ch;\r\n\twidth: 100%;\r\n\toverflow: hidden;\r\n\t${Css.flex_row.horz.left}\r\n\t${Css.flex_row.vert.center}\r\n`;\r\n\r\nconst SlotInnerContainer = styled.div `\r\n\tflex: 1;\r\n\theight: 100%;\r\n\toverflow: hidden;\r\n\tborder-bottom: 2px solid rgba(0,0,0,0.15);\r\n\t${Css.flex_row.horz.left}\r\n\t${Css.flex_row.vert.center}\r\n`;\r\n\r\nconst UserList = styled.div `\r\n\theight: 100%;\r\n\twidth: 100%;\r\n\tbackground-color: white;\r\n\t${Css.flex_col.vert.top}\r\n\t${Css.flex_col.horz.center}\r\n\tuser-select: text;\r\n`","export default __webpack_public_path__ + \"static/media/blue_planet.13ad91ff.svg\";","export default __webpack_public_path__ + \"static/media/cyan_planet.f7f5fde8.svg\";","export default __webpack_public_path__ + \"static/media/earth.5820ba12.svg\";","export default __webpack_public_path__ + \"static/media/jupiter.2a74c919.svg\";","export default __webpack_public_path__ + \"static/media/moon.fe14d20b.svg\";","export default __webpack_public_path__ + \"static/media/orange_planet.bbf32967.svg\";","export default __webpack_public_path__ + \"static/media/red_planet.3a0827a7.svg\";","export default __webpack_public_path__ + \"static/media/ring_planet.0b6db24e.svg\";","export default __webpack_public_path__ + \"static/media/star.3c47846d.svg\";","import { useSpring, animated } from 'react-spring';\r\nimport styled from \"styled-components\";\r\nimport { Css } from 'commons/SharedStyle';\r\n\r\n//=========== 引入星球SVG，用 Affinity Designer 生成的 ====================\r\nimport Blue from \"assets/blue_planet.svg\";\r\nimport Cyan from \"assets/cyan_planet.svg\";\r\nimport Earth from \"assets/earth.svg\";\r\nimport Jupiter from \"assets/jupiter.svg\";\r\nimport Moon from \"assets/moon.svg\";\r\nimport Orange from \"assets/orange_planet.svg\";\r\nimport Red from \"assets/red_planet.svg\";\r\nimport Ring from \"assets/ring_planet.svg\";\r\nimport Star from \"assets/star.svg\";\r\n\r\n//springProps 是通过 useSpring 生成的， slowDown 数值越大跟随鼠标的速度和幅度就越小\r\nfunction Panel({x, y, slowDown, springProps, children}) {\r\n    const trans = (tx, ty) => `translate3d(${tx/slowDown + x}px, ${ty/slowDown + y}px,0)`;\r\n    const style = { transform: springProps.xy.interpolate(trans) };\r\n    return (\r\n        <PanelDiv style={style}>\r\n            {children}\r\n        </PanelDiv>\r\n    );\r\n}\r\n\r\n//springProps 是通过 useSpring 生成的， slowDown 数值越大跟随鼠标的速度和幅度就越小\r\nfunction Planet({svg, x, y, w, slowDown, springProps}) {\r\n    const trans = (tx, ty) => `translate3d(${tx/slowDown + x}px, ${ty/slowDown + y}px, 0)`;\r\n    const style = { width:`${w}ch`, transform: springProps.xy.interpolate(trans) };\r\n    return (\r\n        <Img src={svg} style={style} />\r\n    );\r\n}\r\n\r\n//============================== 太空登录界面 ============================\r\nexport default function LoginSpace({ children }) {\r\n    const [props, set] = useSpring(() => ({ xy: [0, 0], config: { mass: 10, tension: 600, friction: 100 } }));\r\n    const calc = (x, y) => [x - window.innerWidth / 2, y - window.innerHeight / 2];\r\n\r\n    return (\r\n        <Container onMouseMove={({ clientX: x, clientY: y }) => set({ xy: calc(x, y) })}>\r\n            <StarImg src={Star} x={800} y={-200} w={5} />\r\n            <StarImg src={Star} x={-800} y={-100} w={2.5} />\r\n            <StarImg src={Star} x={600} y={300} w={3.5} />\r\n            <StarImg src={Star} x={730} y={-170} w={2} />\r\n            <StarImg src={Star} x={-400} y={200} w={2} />\r\n            <StarImg src={Star} x={-300} y={260} w={4} />\r\n            <StarImg src={Star} x={300} y={-50} w={4} />\r\n            <StarImg src={Star} x={50} y={-350} w={10} />\r\n            <StarImg src={Star} x={150} y={-330} w={2} />\r\n\r\n            <Planet svg={Orange} x={550} y={-200} w={14} slowDown={52} springProps={props} />\r\n            <Planet svg={Jupiter} x={400} y={-290} w={30} slowDown={35} springProps={props} />\r\n            <Planet svg={Ring} x={-200} y={-120} w={120} slowDown={23} springProps={props} />\r\n            <Planet svg={Blue} x={570} y={100} w={16} slowDown={18} springProps={props} />\r\n            <Planet svg={Red} x={150} y={150} w={44} slowDown={10} springProps={props} />\r\n            <Planet svg={Cyan} x={-300} y={-220} w={15} slowDown={5} springProps={props} />\r\n            <Planet svg={Earth} x={-330} y={-180} w={20} slowDown={3} springProps={props} />\r\n            <Planet svg={Moon} x={-380} y={-150} w={6} slowDown={2.5} springProps={props} />\r\n            <Panel  x={0} y={0} slowDown={40} springProps={props} >{children}</Panel>\r\n        </Container>\r\n    )\r\n}\r\n\r\n//======================= style ==========================\r\n//#212F40, #4f719b\r\nconst Container = styled.div `\r\n    height: 100%;\r\n    width: 100%;\r\n\toverflow: hidden;\r\n    /* color: #003e3e; */\r\n    background-image: linear-gradient(150deg,  #4f719b,  #583056 , #003e3e);\r\n    ${Css.flex_col.vert.center}\r\n    ${Css.flex_col.horz.center}\r\n`;\r\n\r\nconst Img = styled(animated.img) `\r\n    position: absolute;\r\n    will-change: transform;\r\n    -webkit-filter: drop-shadow( 0px 0px 6px rgba(255, 255, 255, 0.3));\r\n    filter: drop-shadow( 0px 0px 6px rgba(255, 255, 255, 0.3));\r\n    ${Css.img_protection}\r\n`;\r\n\r\nconst StarImg = styled.img `\r\n    position: absolute;\r\n    width: ${props=>props.w}ch;\r\n    transform: translate3d( ${props=>props.x}px, ${props=>props.y}px, 0);\r\n    -webkit-filter: drop-shadow( 0px 0px 10px rgba(255, 255, 255, 0.8));\r\n    filter: drop-shadow( 0px 0px 10px rgba(255, 255, 255, 0.8));\r\n    ${Css.img_protection}\r\n`;\r\n\r\nconst PanelDiv = styled(animated.div) `\r\n    height: 48ch;\r\n    width: 45ch;\r\n\toverflow: hidden;\r\n    border-radius: 4ch;\r\n    background-color: rgba(255, 255, 255, 0.2);\r\n    -webkit-backdrop-filter: blur(10px);\r\n    -webkit-filter: drop-shadow( 0px 0px 10px rgba(0, 0, 0, 0.6));\r\n    filter: drop-shadow( 0px 0px 10px rgba(0, 0, 0, 0.6));\r\n    backdrop-filter: blur(10px);\r\n    ${Css.flex_col.vert.center}\r\n    ${Css.flex_col.horz.center}\r\n`;\r\n","//通用特定的动画hook\r\nimport { useRef, useState } from 'react';\r\nimport { useSpring } from 'react-spring';\r\n\r\n//===================== useScaleAnim ======================\r\n/**\r\n * @description useScaleAnim 使用弹动动画\r\n * @param {number} initScale - 初始scale\r\n * @param {object} config - （可选）spring 的 config 物理参数  \r\n * @return {[style:object, setScale:function]} [style, setScale], setScale 为 async 函数, 动画结束时 resolve\r\n */\r\nexport function useScaleAnim(initScale, config) {\r\n\tconst [props, set] = useSpring(()=>({ \r\n\t\tscale: initScale, \r\n\t\tconfig: config || { mass: 1, tension: 370, friction: 10 }\r\n\t}));\r\n\r\n\tconst style = { transform: props.scale.interpolate(v=>`scale(${v})`) };\r\n\r\n\tconst setScale = (newScale, config)=>{\r\n\t\treturn new Promise((resolve, reject)=>{\r\n\t\t\tconst props = { \r\n\t\t\t\tscale: newScale, \r\n\t\t\t\tonRest: resolve,    //当spring那边通过onRest调用resolve时，执行此参数的then回调，也可以await\r\n\t\t\t};\r\n\r\n\t\t\tif(config) {\r\n\t\t\t\tprops.config = config;\r\n\t\t\t}\r\n\t\t\tset(props);\r\n\t\t});\r\n\t};\r\n\r\n\treturn [style, setScale];\r\n}\r\n\r\n//===================== useHorzShake ======================\r\n/**\r\n * @description useShakeAnim 弹动动画hook\r\n * @param {number} transformFunc - 如 i=>`translate3d(${i}px, 0, 0)`, x∈[0,1]\r\n * @param {object} config - （可选）spring 的 config 物理参数  \r\n * @return {[style:object, trigger:function]}\r\n */\r\nexport function useShakeAnim(transformFunc, config) {\r\n\tconst state = useRef(false);\r\n\tconst [props, set] = useSpring(()=>({ \r\n\t\tpercentage: 0,\r\n\t\tconfig: config || { mass: 1, tension: 470, friction: 5 }\r\n\t}));\r\n\r\n\tconst style = { \r\n\t\ttransform: props.percentage\r\n\t\t.interpolate({ range: [0, 0.5, 1], output: [0, 1, 0] })\r\n\t\t.interpolate(transformFunc)\r\n\t};\r\n\r\n\tconst trigger = ()=>{\r\n\t\treturn new Promise((resolve, reject)=>{\r\n\t\t\tstate.current = !state.current;\r\n\t\t\tset({ \r\n\t\t\t\tpercentage: state.current? 1:0,\r\n\t\t\t\tonRest: resolve,    //当spring那边通过onRest调用resolve时，执行此参数的then回调，也可以await\r\n\t\t\t});\r\n\t\t});\r\n\t};\r\n\r\n\treturn [style, trigger];\r\n}","import { useScaleAnim } from \"commons/SharedAnim\";\r\nimport { Css } from \"commons/SharedStyle\";\r\nimport { memo } from \"react\";\r\nimport { animated } from \"react-spring\";\r\nimport styled from \"styled-components\";\r\n\r\nexport default memo( function BounceButton({className, children, onMouseDown, onMouseUp, onMouseLeave, ...rest}) {\r\n    const [style, setScale] = useScaleAnim(1); //使用缩放效果，用默认的弹动设置\r\n\r\n    const newOnMouseDown = ()=> {\r\n        setScale(0.9); //按下时缩小\r\n        onMouseDown && onMouseDown(); //合并外部传第的onMouseDown()\r\n    };\r\n\r\n    const newOnMouseUp = ()=> {\r\n        setScale(1); //放开时回到原来大小\r\n        onMouseUp && onMouseUp(); //合并外部传第的onMouseDown()\r\n    };\r\n\r\n    const newOnMouseLeave = ()=> {\r\n        setScale(1); //放开时回到原来大小\r\n        onMouseLeave && onMouseLeave(); //合并外部传第的onMouseDown()\r\n    };\r\n\r\n    return (\r\n        <Button className = {className} \r\n        style = {style} \r\n        onMouseDown = {newOnMouseDown}\r\n        onMouseUp = {newOnMouseUp}\r\n        onMouseLeave = {newOnMouseLeave}\r\n        {...rest} >\r\n            {children}\r\n        </Button>\r\n    );\r\n})\r\n\r\n\r\nconst Button = styled(animated.button) `\r\n    height: 6ch;\r\n\twidth: 30ch;\r\n    margin: 1.5ch;\r\n    color: white;\r\n    background-color: #ff80c0;\r\n    border-radius: 4ch;\r\n    border: none;\r\n    cursor: pointer;\r\n    overflow: hidden;\r\n\r\n    ${Css.flex_col.vert.center}\r\n\t${Css.flex_col.horz.center}\r\n\r\n    /* 从左往右的闪光效果， css transition 动画 */\r\n    ${Css.hover_blink.forward}\r\n\t${Css.hover_blink.backward}\r\n\r\n    :focus{\r\n        outline: none;\r\n    }\r\n\r\n    \r\n`;","export default __webpack_public_path__ + \"static/media/loading.13f33801.svg\";","import LoadingSVG from \"assets/loading.svg\"; //载入月亮绕地球的SVG\r\nimport { memo } from \"react\";\r\nimport { animated, useSpring } from \"react-spring\";\r\nimport styled from \"styled-components\";\r\n\r\nexport default memo( function LoadingAnim({className}) {\r\n    // 一定的初速度 + 0 阻力，使动画在启动时就开始无限钟摆, \r\n    // 使用 memo 是为了防止父节点更新时，导致这里重渲染而改变动画\r\n    const {i} = useSpring({ i:0, config:{mass:70, tensor:1.5, friction: 0, velocity:10} }); \r\n\r\n    return (\r\n        <LoadingImg \r\n        className = {className}\r\n        src = {LoadingSVG}\r\n        style = {{ transform: i.interpolate(i=>`rotate(${i*45}deg)`) }}\r\n        />\r\n    );\r\n})\r\n\r\n\r\n//======================= style ==========================\r\nconst LoadingImg = styled(animated.img) `\r\n    width : 10ch;\r\n    -webkit-filter: drop-shadow( 0px 0px 10px rgba(0, 0, 0, 0.2));\r\n    filter: drop-shadow( 0px 0px 10px rgba(0, 0, 0, 0.2));\r\n`;","import { useAuth } from \"providers/AuthProvider\";\r\nimport { useRef, useState } from \"react\";\r\nimport styled from \"styled-components\";\r\nimport BounceButton from \"./BounceButton\";\r\nimport { animated } from \"react-spring\";\r\nimport { useShakeAnim } from \"commons/SharedAnim\";\r\nimport LoadingAnim from \"views/LoadingAnim\";\r\n\r\n//=================== 邀请码输入框 ===========================\r\nfunction InvitationCode({reference, style, ...rest}) {\r\n    //使用抖动效果，使x方向抖动，幅度为 2ch\r\n    const [animStyle, triggerShaking] = useShakeAnim(i=>`translate3d(${i*2}ch, 0, 0)`); \r\n    //用于将抖动触发函数通过 reference 传第到组件外部\r\n    reference.current = { triggerShaking };\r\n\r\n    return (\r\n        <Input type = 'password'\r\n        placeholder = 'INVITATION CODE'\r\n        style = {{ ...animStyle, ...style }}\r\n        {...rest}\r\n        />\r\n    );\r\n}\r\n\r\nexport default function LoginPanel1() {\r\n\tconst auth = useAuth(); //用于获得登录函数 auth.login();\r\n    const inputRef = useRef(); //输入框引用，用于在外部调用输入框内部的抖动函数 inputRef.current.triggerShaking()\r\n    const [password, setPassword] = useState('');\r\n    const [error, setError] = useState(null);\r\n    const [isLoading, setLoading] = useState(false);\r\n\r\n\tconst onClick = async ()=>{\r\n        //防止正在登录验证时点击Login按钮\r\n        if(isLoading) \r\n            return;\r\n\r\n        setLoading(true); //开始显示 loading 动画\r\n        const isSuccess = await auth.login('stephen@invited.com', password); //等待登录成功\r\n        setLoading(false);  //结束 loading 动画\r\n\r\n        if(!isSuccess) {\r\n            setError('Invalid invitation code!');\r\n            inputRef.current.triggerShaking(); //触发输入框抖动效果\r\n        } \r\n\t};\r\n\r\n    //输入的东西显示到输入框\r\n    const onChange = (e)=> {\r\n        setPassword(e.target.value);\r\n        setError(null);\r\n    };\r\n\r\n\treturn (\r\n        <>\r\n            <InvitationCode reference={inputRef} value={password} onChange={onChange} />\r\n            <Button onClick={onClick}> LOGIN </Button>\r\n            { !isLoading && error && <ErrorMsg>{error}</ErrorMsg> }\r\n            { isLoading && <LoadingAnim/> }\r\n        </>\r\n\t)\r\n}\r\n\r\n\r\n//======================= style ==========================\r\nconst ErrorMsg = styled.p `\r\n    color: #fad692;\r\n    text-shadow: 0px 0px 13px rgba(0, 0, 0, 0.5);\r\n`;\r\n\r\n\r\nconst Input = styled(animated.input) `\r\n    height: 6ch;\r\n\twidth: 30ch;\r\n    margin: 1.5ch;\r\n    color: #2c2c4e;\r\n    background-color: white;\r\n    border-radius: 4ch;\r\n    border: none;\r\n    text-align: center;\r\n\r\n    :focus{\r\n        outline: none;\r\n    }\r\n`;\r\n\r\n//#53c6b1\r\nconst Button = styled(BounceButton) `\r\n    height: 6ch;\r\n\twidth: 30ch;\r\n    margin: 1.5ch;\r\n    color: white;\r\n    background-color: #53c6b1;\r\n    border-radius: 4ch;\r\n`;\r\n","import { usePeerClient } from \"providers/PeerClientProvider\";\r\nimport { useRef, useState } from \"react\";\r\nimport styled from \"styled-components\";\r\nimport BounceButton from \"./BounceButton\";\r\nimport { animated } from \"react-spring\";\r\nimport { useScaleAnim, useShakeAnim } from \"commons/SharedAnim\";\r\nimport LoadingAnim from \"views/LoadingAnim\";\r\nimport { useHistory, useLocation } from \"react-router-dom\";\r\nimport { HOME } from \"views_router/AppRouter\";\r\nimport { Css } from \"commons/SharedStyle\";\r\nimport { useMe } from \"providers/PeerClient_MeProvider\";\r\n\r\n\r\nfunction UserPhoto({reference, src, onChange}) {\r\n    const [shakeStyle, triggerShaking] = useShakeAnim(i=>`translate3d(${i*1.5}ch, 0, 0)`); //出错时的抖动动画\r\n    const [scaleStyle, setScale] = useScaleAnim(1); //点击时的缩放动画\r\n    const [animStyle, setStyle] = useState(scaleStyle);  //用于切换抖动和缩放动画\r\n    const id = 'login_user_photo'; //用来关联 label 和 input 组件\r\n\r\n    //此组件的引用，用于导出动画触发函数给外部使用\r\n    reference.current = { \r\n        triggerShaking: ()=>{ \r\n            setStyle(shakeStyle); //触发动画前先设置成抖动动画\r\n            triggerShaking();\r\n        }\r\n    };\r\n\r\n    return (\r\n        <>\r\n            <Label\r\n            htmlFor = {id}\r\n            onMouseDown = {()=>{ setStyle(scaleStyle); setScale(0.85); }}\r\n            onMouseUp = {()=>{ setStyle(scaleStyle); setScale(1); }}\r\n            onMouseLeave = {()=>{ setStyle(scaleStyle); setScale(1); }}\r\n            style = {animStyle}>\r\n                <Img src={src} />\r\n            </Label>\r\n\r\n            <FileInput \r\n            id = {id}\r\n            type = 'file'\r\n            accept = 'image/*'\r\n            onChange = {onChange}\r\n            />\r\n        </>\r\n    );\r\n}\r\n\r\nfunction UserName({reference, ...rest}) {\r\n    const [style, triggerShaking] = useShakeAnim(i=>`translate3d(${i}ch, 0, 0)`); //出错时的抖动动画\r\n    reference.current = { triggerShaking }; //此组件的引用，用于导出动画触发函数给外部使用\r\n\r\n    return (\r\n        <Input type = 'text'\r\n        placeholder = 'YOUR USER NAME'\r\n        style = {style}\r\n        {...rest}\r\n        />\r\n    );\r\n}\r\n\r\nexport default function LoginPanel2() {\r\n    const { connectToServer } = usePeerClient(); //context 数据\r\n    const { info: {name, photoURL}, setName, setPhoto } = useMe(); //context 数据\r\n    const nameRef = useRef(); //用户名输入框的引用\r\n    const photoRef = useRef(); //头像框的引用\r\n    const [isLoading, setLoading] = useState(false);\r\n    const [error, setError] = useState(null);\r\n    const location = useLocation();\r\n\tconst history = useHistory();\r\n\r\n\tconst onClick = async ()=>{\r\n        try {\r\n            setError(null);\r\n            setName(name, true); //true 代表name为最终确定的名字\r\n            setLoading(true);\r\n            connectToServer();\r\n            history.replace(location.state? location.state.from : HOME); \r\n        }\r\n        //setName() 无效时丢出错误\r\n        catch(error) {\r\n            setError(error); //错误信息\r\n            nameRef.current.triggerShaking(); //触发输入框抖动效果\r\n        }\r\n\t};\r\n\r\n    const onNameChange = (event)=> {\r\n        try {\r\n            setError(null);\r\n            setName( event.target.value, false ); //false 代表目前输入的名字是临时的\r\n        }\r\n        //setName() 无效时丢出错误\r\n        catch(error) {\r\n            setError(error);\r\n            nameRef.current.triggerShaking(); //触发输入框抖动效果\r\n        }\r\n    };\r\n\r\n    const onFileChange = (event)=> {\r\n        //用户直没有选择文件，接关闭文件选择窗口时\r\n        if(!event.target.files || !event.target.files[0]) { \r\n            return;\r\n        } \r\n        try {\r\n            setError(null);\r\n            setPhoto(event.target.files[0]);\r\n        }\r\n        //setPhoto() 无效时丢出错误\r\n        catch(error) {\r\n            setError(error);\r\n            photoRef.current.triggerShaking(); //触发输入框抖动效果\r\n        }\r\n    }   \r\n\r\n\treturn (\r\n        <>\r\n            <UserPhoto reference={photoRef} src={photoURL}  onChange={onFileChange}/>\r\n            <UserName reference={nameRef} value={name} onChange={onNameChange} />\r\n            { !isLoading && <Button onClick={onClick}> START </Button> }\r\n            { !isLoading && error && <ErrorMsg>{error}</ErrorMsg> }\r\n            { isLoading && <LoadingAnim/> }\r\n        </>\r\n\t)\r\n}\r\n\r\n\r\n//======================= style ==========================\r\nconst Label = styled(animated.label) `\r\n    width: 15ch;\r\n    height: 15ch;\r\n    margin: 1.5ch;\r\n    border-radius: 10ch;\r\n    border: none;\r\n    overflow: hidden;\r\n    box-shadow: 0px 0px 13px rgba(0, 0, 0, 0.5);\r\n    cursor: pointer;\r\n    ${Css.hover_blink.forward}\r\n    ${Css.hover_blink.backward}\r\n    \r\n    ${Css.flex_col.horz.center}\r\n    ${Css.flex_col.vert.center}\r\n    :after {\r\n        border-radius: 0ch;\r\n    }\r\n`;\r\n\r\nconst ErrorMsg = styled.p `\r\n    color: #fad692;\r\n    text-shadow: 0px 0px 13px rgba(0, 0, 0, 0.5);\r\n`;\r\n\r\nconst Img = styled.img `\r\n    height: 100%;\r\n\twidth:  100%;\r\n    ${Css.img_protection}\r\n`;\r\n\r\nconst Input = styled(animated.input) `\r\n    height: 6ch;\r\n\twidth: 30ch;\r\n    margin: 1.5ch;\r\n    color: #2c2c4e;\r\n    background-color: white;\r\n    border-radius: 4ch;\r\n    border: none;\r\n    text-align: center;\r\n\r\n    :focus{\r\n        outline: none;\r\n    }\r\n`;\r\n\r\nconst FileInput = styled.input `\r\n    height: 0;\r\n\twidth: 0;\r\n    opacity: 0;\r\n    border: none;\r\n    :focus{\r\n        outline: none;\r\n    }\r\n`;\r\n\r\n//#53c6b1\r\nconst Button = styled(BounceButton) `\r\n    height: 6ch;\r\n\twidth: 30ch;\r\n    margin: 1.5ch;\r\n    color: white;\r\n    background-color: #d071b4;\r\n    border-radius: 4ch;\r\n`;\r\n","import { useScaleAnim } from \"commons/SharedAnim\";\r\nimport styled from \"styled-components\";\r\nimport { animated } from \"react-spring\";\r\nimport { memo } from \"react\";\r\n\r\nexport default memo( function PopupContainer({reference, isPopup, isShownAtStart, children, className}) {\r\n\tconst [style, setScale] = useScaleAnim(isShownAtStart? 1 : 0); //设置初始大小\r\n\r\n\tconst handler = { \r\n\t\t//弹出\r\n\t\tpopup: async (delay)=>{ \r\n\t\t\t//若定义delay，则延时弹出\r\n\t\t\tdelay && (await new Promise(resolve => setTimeout(resolve, delay))); //延时\r\n\t\t\treturn setScale(1, { mass: 1, tension: 370, friction: 10 });  //弹动效果的物理参数\r\n\t\t},\r\n\t\t\r\n\t\t//缩回\r\n\t\thide: async (delay)=>{ \r\n\t\t\t//若定义delay，则延时弹出\r\n\t\t\tdelay && (await new Promise(resolve => setTimeout(resolve, delay))); //delay\r\n\t\t\treturn setScale(0, { mass: 1, tension: 400, friction: 35 });  //没有弹动效果的物理参数\r\n\t\t}\r\n\t};\r\n\t\r\n\t//通过reference 或 isPopup 来控制弹出缩回，两种方法\r\n\tif(reference) {\r\n\t\t//用于外部调用PopupContainer的 popup() 和 hide()\r\n\t\treference.current = handler;\r\n\t}\r\n\telse if(isPopup) {\r\n\t\t//用于通过props控制 popup 的 isPopup 控制弹出\r\n\t\thandler.popup();\r\n\t}\r\n\telse {\r\n\t\t//用于通过props 的 isPopup 控制隐藏\r\n\t\thandler.hide();\r\n\t}\r\n\t\r\n\treturn (\r\n\t\t<PopupDiv style={style} className={className}>\r\n\t\t\t{children}\r\n\t\t</PopupDiv>\r\n\t);\r\n})\r\n\r\n//======================= style ==========================\r\nconst PopupDiv = styled(animated.div) `\r\n\twidth: 100%;\r\n\theight: 100%;\r\n`;\r\n","import { useAuth } from \"providers/AuthProvider\";\r\nimport { Css } from \"commons/SharedStyle\";\r\nimport styled from \"styled-components\";\r\nimport LoginSpace from \"views/LoginSpace\";\r\nimport LoginPanel1 from \"views/LoginPanel1\";\r\nimport LoginPanel2 from \"views/LoginPanel2\";\r\nimport { useEffect, useRef, useState } from \"react\";\r\nimport PopupContainer from \"views/PopupContainer\";\r\n\r\n//分割出来的动态组件，防止状态刷新时重渲染LoginSpace组件\r\nfunction PanelSwitcher() {\r\n\tconst auth = useAuth();\r\n\tconst popupRef = useRef(null);  //PopupContainer的引用\r\n\tconst [panelID, setPanelID] = useState(1); //面板ID\r\n\r\n\tuseEffect(async ()=>{\r\n\t\tif(auth.isInit) {\r\n\t\t\t//若发生自动登录，则无需弹出第一个面板\r\n\t\t\tif(!auth.user) {\r\n\t\t\t\tpopupRef.current.popup(300); //延时 300ms 再弹出\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\telse {\r\n\t\t\t\tawait popupRef.current.hide(); //等待缩回动画结束\r\n\t\t\t\tsetPanelID(2); //切换到第二个面板\r\n\t\t\t\tpopupRef.current.popup(400); //延时 400ms 再弹出\r\n\t\t\t}\r\n\t\t}\r\n\t},[auth.isInit, auth.user]);\r\n\r\n\treturn (\r\n\t\t<Popup reference={popupRef} isShownAtStart={false}>\r\n\t\t\t{(panelID===1) && <LoginPanel1/>}\r\n\t\t\t{(panelID===2) && <LoginPanel2/>}\r\n\t\t</Popup>\r\n\t);\r\n}\r\n\r\n//静态组件，不受PanelSwitcher重渲染的影响\r\nexport default function Login() {\r\n\treturn (\r\n\t\t<LoginSpace>\r\n\t\t\t<PanelSwitcher/>\r\n\t\t</LoginSpace>\r\n\t);\r\n}\r\n\r\n//======================= style ==========================\r\nconst Popup = styled(PopupContainer) `\r\n\twidth: 100%;\r\n\theight: 100%;\r\n\toverflow: hidden;\r\n\t${Css.flex_col.horz.center}\r\n\t${Css.flex_col.vert.center}\r\n`;\r\n","import { useAuth } from \"providers/AuthProvider\";\r\nimport { Css } from \"commons/SharedStyle\";\r\nimport styled from \"styled-components\";\r\n\r\nexport default function Profile() {\r\n\tconst auth = useAuth();\r\n\r\n\treturn (\r\n\t\t<Div>\r\n\t\t\t{auth.user && auth.user.email}\r\n\t\t</Div>\r\n\t)\r\n}\r\n\r\nconst Div = styled.div `\r\n\theight: 400px;\r\n\twidth: 100%;\r\n\tbackground-color: lightseagreen;\r\n\t${Css.flex_col.vert.in_out_space}\r\n\t${Css.flex_col.horz.left}\r\n`","import { useAuth } from \"providers/AuthProvider\";\r\nimport { usePeerClient } from \"providers/PeerClientProvider\";\r\nimport { Css } from \"commons/SharedStyle\";\r\nimport { HashRouter, Link, Redirect, Route, Switch, useLocation } from \"react-router-dom\";\r\nimport styled from \"styled-components\";\r\nimport GroupChat from \"./GroupChat\";\r\nimport Home from \"./Home\";\r\nimport Login from \"./Login\";\r\nimport Profile from \"./Profile\";\r\nimport LoadingAnim from \"views/LoadingAnim\";\r\nimport { memo } from \"react\";\r\nimport { usePeerServer } from \"providers/PeerServerProvider\";\r\nimport { version } from \"commons/constants\";\r\n\r\n\r\n//================ 常量，其他文件也可以访问 =========================\r\nexport const LOGIN = '/login';\r\nexport const HOME = '/';\r\nexport const GROUPCHAT = '/groupchat';\r\nexport const PROFILE = '/profile';\r\n\r\n\r\n//================ 在 Switch 里的默认路由路径，放在Switch里最后，当路径不存在时转到这里 =========================\r\nfunction DefaultRoute({ redirectPath }) {\r\n    const location = useLocation(); //重定向之前记住来时的路径 location.state.from\r\n    //当 Switch 找不到前面的路径，任意路径 \"*\" 将导到这里再重定向\r\n    return (\r\n        <Route path='*' >\r\n            <Redirect to={{ pathname: redirectPath, state: { from: location } }} />\r\n        </Route>\r\n    );\r\n}\r\n\r\n// 分出LoginRouter组件并变成memo，是为了防止 useAuth().user 状态改变时，重渲染整个Login界面(包括LoginSpace)\r\nconst LoginRouter = memo(()=> {\r\n    return (\r\n        <Switch>\r\n            <Route exact path={LOGIN}> <Login/> </Route>\r\n            <DefaultRoute redirectPath={LOGIN}/>\r\n        </Switch>\r\n    )\r\n})\r\n\r\nfunction MainRouter() {\r\n    const auth = useAuth();\r\n    return (\r\n        <>\r\n            <Switch>\r\n                <Route exact path={HOME}> <Home/> </Route>\r\n                <Route exact path={GROUPCHAT}> <GroupChat/> </Route>\r\n                <Route exact path={PROFILE}> <Profile/>  </Route>\r\n                <DefaultRoute redirectPath={HOME}/>\r\n            </Switch>\r\n\r\n            <Navigation>\r\n                <NavButton to={HOME}>Home</NavButton>\r\n                <NavButton to={GROUPCHAT}>Group Chat</NavButton>\r\n                <NavButton to={PROFILE}>Profile</NavButton>\r\n                <button onClick={()=>auth.logout()}>sign out</button>\r\n            </Navigation>\r\n        </>\r\n    );\r\n}\r\n\r\n//================ App Route =========================\r\nexport default function AppRouter() {\r\n    const auth = useAuth();\r\n    const server = usePeerServer();\r\n    const client = usePeerClient(); \r\n\r\n    return (\r\n        <>{\r\n            //判断是否在自动登录\r\n            (auth.isInit && server.isInit && client.isInit) ? ( \r\n                //因为后端部署在github page，无法控制路由路径，于是用HashRouter加‘#’区分前后端路由\r\n                <HashRouter>{ \r\n                    (auth.user && client.isConnectedToServer) ? (  \r\n                        //Login 的两个界面都通过后, 切换成MainRouter\r\n                        <MainRouter/>\r\n                    ) : (\r\n                        <LoginRouter/>\r\n                    )\r\n                }</HashRouter>\r\n            ) : (\r\n                <>\r\n                    <BigLodingAnim/>\r\n                    <Version>version: {version}</Version>\r\n                </>\r\n            )\r\n        }</>\r\n    );\r\n}\r\n\r\n\r\n//======================= style ==========================\r\nconst BigLodingAnim = styled(LoadingAnim) `\r\n    width: 30ch;\r\n`\r\n\r\nconst NavButton = styled(Link) `\r\n    flex: 1;\r\n    height: 100%;\r\n    color: black;\r\n    text-decoration: none;\r\n    ${Css.flex_row.horz.center}\r\n    ${Css.flex_row.vert.center}\r\n`;\r\n\r\nconst Navigation = styled.div `\r\n    width: 100%;\r\n    height: 50px;\r\n    background-color: #ececec;\r\n    ${Css.flex_row.horz.in_out_space}\r\n    ${Css.flex_row.vert.center}\r\n`;\r\n\r\nconst Version = styled.p `\r\n    color: rgba(255,255,255,0.3);\r\n    margin: 1.5ch;\r\n`;","import styled from 'styled-components';\r\nimport { Css, GlobalStyle } from 'commons/SharedStyle';\r\nimport AuthProvider from 'providers/AuthProvider'; //登录验证的逻辑组件\r\nimport PeerClientProvider from 'providers/PeerClientProvider'; //Peer 节点组件\r\nimport PeerServerProvider from 'providers/PeerServerProvider'; //特殊的 Peer 节点，节点服务器\r\n\r\nimport AppRouter from 'views_router/AppRouter';\r\n\r\nfunction App() {\r\n  \treturn (\r\n\t\t<AppContainer>\r\n\t\t\t<GlobalStyle/>\r\n\t\t\t<AuthProvider>\r\n\t\t\t\t<PeerServerProvider>\r\n\t\t\t\t\t<PeerClientProvider>\r\n\r\n\t\t\t\t\t\t<AppRouter />\r\n\r\n\t\t\t\t\t</PeerClientProvider>\r\n\t\t\t\t</PeerServerProvider>\r\n\t\t\t</AuthProvider>\r\n\t\t</AppContainer>\r\n\t);\r\n}\r\n\r\nconst AppContainer = styled.div`\r\n\tbackground-color: #ffffff;\r\n\twidth: 100%;\r\n\theight: 100%;\r\n\toverflow: hidden;\r\n\t${Css.flex_col.horz.center}\r\n\t${Css.flex_col.vert.center}\r\n\tbackground-image: linear-gradient(150deg,  #4f719b,  #583056 , #003e3e);\r\n`\r\n\r\nexport default App;\r\n","const reportWebVitals = onPerfEntry => {\r\n  if (onPerfEntry && onPerfEntry instanceof Function) {\r\n    import('web-vitals').then(({ getCLS, getFID, getFCP, getLCP, getTTFB }) => {\r\n      getCLS(onPerfEntry);\r\n      getFID(onPerfEntry);\r\n      getFCP(onPerfEntry);\r\n      getLCP(onPerfEntry);\r\n      getTTFB(onPerfEntry);\r\n    });\r\n  }\r\n};\r\n\r\nexport default reportWebVitals;\r\n","import React from 'react';\r\nimport ReactDOM from 'react-dom';\r\nimport App from 'App';\r\nimport reportWebVitals from '_init_/reportWebVitals';\r\n\r\nReactDOM.render(\r\n  <React.StrictMode>\r\n    <App />\r\n  </React.StrictMode>,\r\n  document.getElementById('root')\r\n);\r\n\r\n// If you want to start measuring performance in your app, pass a function\r\n// to log results (for example: reportWebVitals(console.log))\r\n// or send to an analytics endpoint. Learn more: https://bit.ly/CRA-vitals\r\nreportWebVitals();\r\n"],"sourceRoot":""}